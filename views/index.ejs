<!DOCTYPE html>
<html lang="en">
<head>

    <%-include ('partials/header.ejs') %>

</head>
<body>

<%-include ('partials/nav.ejs') %>
   


<div class="container mt-4">
    <!-- Filter Section -->
    <div class="filter-box">
        <form action="/" method="GET">
            <div class="col-md-6">
                <label class="form-label fw-bold" for="category">Select Category: </label>
                <select id="category" name="category" class="form-select mb-3">
                    <option disabled selected>Choose one</option>
                    <option>All</option>
                    <option value="clothes">Clothes</option>                    
                    <option value="bags">Bags</option>
                    <option value="books">Books</option>
                </select>
                <div class="col-md-3 mt-3 mt-md-0">
                    <input type="submit" value="Filter" class="btn btn-primary w-100">
                </div>
            </div>
        </form>
    </div>

    <!-- Validation Errors -->
    <%if(validationError.length > 0){ %>
            <%validationError.forEach(err=>{ %>
                <p class="alert alert-danger"> <%= err.msg %>  </p>

            <%}) %>            
    <%} %>   
    
    <!-- Product Grid -->
    <div class="row mt-4">
        <%if(products && products.length > 0){  %>     
        <%products.forEach((product) => { %>
        
        <div class="col-12 col-sm-6 col-md-4 col-lg-3 mb-4 ">
            <div class="card product-card" >
                <img src="<%= product.image%>" class="card-img-top fixed-img" alt="Error Loading image">
                <div class="card-body">
                    <h5 class="card-title mb-2">
                    <a href="/product/<%= product._id%>" ><%=product.name%></a>
                    </h5>
                    <p class="text-muted mb-2 fw-bold">Price: <%= product.price %>$</p>                                       
                    
                    <form action="/cart" method="post" class="add-to-cart-form">
                      <div class="label">
                      <label for="quantity" class="fw-semibold"> Quantity : </label>
                      <input type="number" name="amount" id="quantity" value="1" min="1" class="form-control amount mb-3">
                      </div>
                      <input type="hidden" name="name" value="<%=product.name%>">
                      <input type="hidden" name="price" value="<%=product.price%>">
                      <input type="hidden" name="productId" value="<%=product._id%>">
                      <input type="hidden" name="redirectTo" value="/">
                     <input type="submit" value="Add to cart" class="btn btn-primary add-btn">
                    </form>
                    
                </div>
            </div>
        </div>
        <%})%>
        <%} else{%>
        
            <div class="alert alert-danger text-center py-4" >
                <p>There is no Products</p>
            </div>

        <%}%>
    </div>
</div>
</body>


<%-include ('partials/footer.ejs') %>

</html>